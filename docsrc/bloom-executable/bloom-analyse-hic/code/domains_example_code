# start snippet domains basic
bloomplot -o architecture/domains/bloom_example_100kb_tads.png chr18:18mb-28mb \
     -p triangular output/hic/binned/bloom_example_100kb.hic -m 4000000 \
     -vmin 0 -vmax 0.05
# end snippet domains basic
bloomplot -o ../docsrc/bloom-executable/bloom-analyse-hic/images/bloom_example_100kb_tads.png chr18:18mb-28mb \
     -p triangular output/hic/binned/bloom_example_100kb.hic -m 4000000 \
     -vmin 0 -vmax 0.05

# start snippet domains window
bloom insulation output/hic/binned/bloom_example_100kb.hic \
                architecture/domains/bloom_example_100kb.insulation \
                -w 1000000 1500000 2000000 2500000 3000000 3500000 4000000
# end snippet domains window

# start snippet domains scores
bloomplot -o architecture/domains/bloom_example_50kb_tads_insulation.png chr18:18mb-28mb \
     -p triangular output/hic/binned/bloom_example_100kb.hic -m 4000000 -vmin 0 -vmax 0.05 \
     -p scores architecture/domains/bloom_example_100kb.insulation
# end snippet domains scores
bloomplot -o ../docsrc/bloom-executable/bloom-analyse-hic/images/bloom_example_50kb_tads_insulation.png chr18:18mb-28mb \
     -p triangular output/hic/binned/bloom_example_100kb.hic -m 4000000 -vmin 0 -vmax 0.05 \
     -p scores architecture/domains/bloom_example_100kb.insulation

# start snippet domains bed
bloom insulation output/hic/binned/bloom_example_100kb.hic \
                architecture/domains/bloom_example_100kb.insulation \
                -w 1000000 1500000 2000000 2500000 3000000 3500000 4000000 \
                -o bed
# end snippet domains bed

# start snippet domains simplebed
bloom insulation architecture/domains/bloom_example_100kb.insulation \
                -o bed
# end snippet domains simplebed

# start snippet domains info
bloom insulation architecture/domains/bloom_example_100kb.insulation
# end snippet domains info


# start snippet domains line
bloomplot --width 6 -o architecture/domains/bloom_example_100kb_tads_insulation_1mb.png \
               chr18:18mb-28mb \
               -p triangular output/hic/binned/bloom_example_100kb.hic -m 4000000 \
               -vmin 0 -vmax 0.05 \
               -p line architecture/domains/bloom_example_100kb.insulation_1mb.bed \
               architecture/domains/bloom_example_100kb.insulation_2mb.bed \
               -l "1mb" "2mb"
# end snippet domains line
bloomplot --width 6 -o ../docsrc/bloom-executable/bloom-analyse-hic/images/bloom_example_100kb_tads_insulation_1mb.png \
               chr18:18mb-28mb \
               -p triangular output/hic/binned/bloom_example_100kb.hic -m 4000000 \
               -vmin 0 -vmax 0.05 \
               -p line architecture/domains/bloom_example_100kb.insulation_1mb.bed \
               architecture/domains/bloom_example_100kb.insulation_2mb.bed \
               -l "1mb" "2mb"


# start snippet domains impute
bloom insulation output/hic/binned/bloom_example_100kb.hic \
                architecture/domains/bloom_example_100kb.insulation_imputed \
                -w 1000000 1500000 2000000 2500000 3000000 3500000 4000000 \
                --impute
# end snippet domains impute

# start snippet domains plotimpute
bloomplot -o architecture/domains/bloom_example_100kb_tads_insulation.png chr18:18mb-28mb \
     -p triangular output/hic/binned/bloom_example_100kb.hic -m 4000000 -vmin 0 -vmax 0.05 \
     -p scores architecture/domains/bloom_example_100kb.insulation_imputed -vmin -1 -vmax 1
# end snippet domains plotimpute
bloomplot -o ../docsrc/bloom-executable/bloom-analyse-hic/images/bloom_example_100kb_tads_insulation_impute.png \
     chr18:18mb-28mb \
     -p triangular output/hic/binned/bloom_example_100kb.hic -m 4000000 -vmin 0 -vmax 0.05 \
     -p scores architecture/domains/bloom_example_100kb.insulation_imputed -vmin -1 -vmax 1

# start snippet domains boundaries
bloom boundaries architecture/domains/bloom_example_100kb.insulation \
                architecture/domains/bloom_example_100kb.insulation_boundaries \
                -w 1mb 2mb
# end snippet domains boundaries

# start snippet domains plotboundaries
bloomplot --width 6 -o architecture/domains/bloom_example_100kb_tads_insulation_1mb_boundaries.png \
     chr18:18mb-28mb \
     -p triangular output/hic/binned/bloom_example_100kb.hic -m 4000000 -vmin 0 -vmax 0.05 \
     -p line architecture/domains/bloom_example_100kb.insulation_1mb.bed -l "1mb" \
     -p bar architecture/domains/bloom_example_100kb.insulation_boundaries_1mb.bed
# end snippet domains plotboundaries
bloomplot --width 6 -o ../docsrc/bloom-executable/bloom-analyse-hic/images/bloom_example_50kb_tads_insulation_1mb_boundaries.png \
     chr18:18mb-28mb \
     -p triangular output/hic/binned/bloom_example_100kb.hic -m 4000000 -vmin 0 -vmax 0.05 \
     -p line architecture/domains/bloom_example_100kb.insulation_1mb.bed -l "1mb" \
     -p bar architecture/domains/bloom_example_100kb.insulation_boundaries_1mb.bed

# start snippet domains minscore
bloom boundaries architecture/domains/bloom_example_100kb.insulation \
                architecture/domains/bloom_example_100kb.insulation_boundaries_score0.7 \
                -w 1mb 2mb --min-score 0.7
# end snippet domains minscore

# start snippet domains directionality
bloom directionality output/hic/binned/bloom_example_100kb.hic \
                    architecture/domains/bloom_example_100kb.directionality \
                    -w 1000000 1500000 2000000 2500000 3000000 3500000 4000000
# end snippet domains directionality

# start snippet domains plotdirectionality
bloomplot -o architecture/domains/bloom_example_100kb_tads_directionality.png chr18:18mb-28mb \
     -p triangular output/hic/binned/bloom_example_100kb.hic -m 4000000 -vmin 0 -vmax 0.05 \
     -p scores architecture/domains/bloom_example_100kb.directionality
# end snippet domains plotdirectionality
bloomplot -o ../docsrc/bloom-executable/bloom-analyse-hic/images/bloom_example_100kb_tads_directionality.png chr18:18mb-28mb \
     -p triangular output/hic/binned/bloom_example_100kb.hic -m 4000000 -vmin 0 -vmax 0.05 \
     -p scores architecture/domains/bloom_example_100kb.directionality